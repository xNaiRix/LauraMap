<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∫–∞—Ä—Ç—ã - LauraMap</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: #2d3748;
            color: white;
            padding: 25px 40px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #63b3ed;
        }
        
        .subtitle {
            color: #a0aec0;
            font-size: 1.1rem;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .map-section {
            position: relative;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            overflow: hidden;
            min-height: 500px;
        }
        
        .map-container {
            width: 100%;
            height: 100%;
            background: #f7fafc;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #mapImage {
            max-width: 100%;
            max-height: 100%;
            transition: transform 0.3s ease;
        }
        
        .point-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #e53e3e;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .point-marker:hover {
            transform: translate(-50%, -50%) scale(1.3);
            background: #c53030;
        }
        
        .point-label {
            position: absolute;
            background: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            white-space: nowrap;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .point-marker:hover .point-label {
            opacity: 1;
        }
        
        .data-section {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 1px solid #e2e8f0;
        }
        
        .card h2 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.5rem;
            border-bottom: 2px solid #63b3ed;
            padding-bottom: 10px;
        }
        
        .info-item {
            margin: 12px 0;
            padding: 8px 0;
            border-bottom: 1px solid #edf2f7;
        }
        
        .info-label {
            font-weight: 600;
            color: #4a5568;
            display: block;
            margin-bottom: 5px;
        }
        
        .info-value {
            color: #718096;
            font-family: monospace;
            word-break: break-all;
        }
        
        .points-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .point-item {
            padding: 15px;
            margin: 10px 0;
            background: #f7fafc;
            border-radius: 10px;
            border-left: 4px solid #4299e1;
            transition: all 0.3s ease;
        }
        
        .point-item:hover {
            background: #ebf8ff;
            transform: translateX(5px);
        }
        
        .point-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #cbd5e0;
        }
        
        .no-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #cbd5e0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #718096;
            font-size: 14px;
        }
        
        .point-name {
            font-weight: 600;
            color: #2d3748;
            font-size: 1.1rem;
        }
        
        .point-coords {
            color: #718096;
            font-size: 0.9rem;
            font-family: monospace;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        #loadBtn {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
        }
        
        #loadBtn:hover {
            background: linear-gradient(135deg, #3182ce 0%, #2b6cb0 100%);
            transform: translateY(-2px);
        }
        
        #loadBtn:active {
            transform: translateY(0);
        }
        
        #clearBtn {
            background: #fed7d7;
            color: #c53030;
        }
        
        #clearBtn:hover {
            background: #fc8181;
            color: white;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #718096;
        }
        
        .loading.active {
            display: block;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4299e1;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            background: #fed7d7;
            border: 2px solid #fc8181;
            color: #c53030;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }
        
        .error.active {
            display: block;
        }
        
        .success-message {
            background: #c6f6d5;
            border: 2px solid #68d391;
            color: #22543d;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }
        
        .success-message.active {
            display: block;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #a0aec0;
            font-size: 0.9rem;
            border-top: 1px solid #e2e8f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üåç LauraMap –¢–µ—Å—Ç</h1>
            <p class="subtitle">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ /api/map</p>
        </header>
        
        <div class="main-content">
            <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ö–∞—Ä—Ç–∞ -->
            <section class="map-section">
                <div class="map-container" id="mapContainer">
                    <!-- SVG –∫–∞—Ä—Ç–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —Å—é–¥–∞ -->
                    <p id="mapPlaceholder">–ö–∞—Ä—Ç–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö...</p>
                </div>
                <!-- –ú–∞—Ä–∫–µ—Ä—ã —Ç–æ—á–µ–∫ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </section>
            
            <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –î–∞–Ω–Ω—ã–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
            <section class="data-section">
                <div class="card">
                    <h2>üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—Ä—Ç–µ</h2>
                    <div class="info-item">
                        <span class="info-label">–°—Ç–∞—Ç—É—Å:</span>
                        <span class="info-value" id="status">–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏...</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã:</span>
                        <span class="info-value" id="mapTitle">‚Äî</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">URL –∫–∞—Ä—Ç—ã:</span>
                        <span class="info-value" id="mapUrl">‚Äî</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫:</span>
                        <span class="info-value" id="pointsCount">0</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞:</span>
                        <span class="info-value" id="responseTime">‚Äî</span>
                    </div>
                    
                    <div class="controls">
                        <button id="loadBtn">
                            <span>üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ä—Ç—É</span>
                        </button>
                        <button id="clearBtn">
                            <span>üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</span>
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <h2>üìç –¢–æ—á–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–µ</h2>
                    <div id="pointsList" class="points-list">
                        <p style="color: #a0aec0; text-align: center; padding: 20px;">
                            –¢–æ—á–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
                        </p>
                    </div>
                </div>
                
                <div class="card">
                    <h2>üìù –û—Ç–≤–µ—Ç API</h2>
                    <pre id="rawResponse" style="
                        background: #f7fafc;
                        padding: 15px;
                        border-radius: 8px;
                        max-height: 200px;
                        overflow-y: auto;
                        font-size: 12px;
                        color: #4a5568;
                    ">{}</pre>
                </div>
            </section>
        </div>
        
        <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>–ó–∞–≥—Ä—É–∂–∞—é –¥–∞–Ω–Ω—ã–µ —Å /api/map...</p>
        </div>
        
        <div class="error" id="error">
            <strong>–û—à–∏–±–∫–∞!</strong> <span id="errorMessage"></span>
        </div>
        
        <div class="success-message" id="success">
            ‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!
        </div>
        
        <footer>
            <p>FastAPI —ç–Ω–¥–ø–æ–∏–Ω—Ç: <code>GET /api/map</code> | –ú–æ–¥–µ–ª—å –æ—Ç–≤–µ—Ç–∞: <code>MapResponse</code></p>
        </footer>
    </div>

    <script>
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const loadBtn = document.getElementById('loadBtn');
        const clearBtn = document.getElementById('clearBtn');
        const mapContainer = document.getElementById('mapContainer');
        const pointsList = document.getElementById('pointsList');
        const loading = document.getElementById('loading');
        const error = document.getElementById('error');
        const success = document.getElementById('success');
        const rawResponse = document.getElementById('rawResponse');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        const statusEl = document.getElementById('status');
        const mapTitleEl = document.getElementById('mapTitle');
        const mapUrlEl = document.getElementById('mapUrl');
        const pointsCountEl = document.getElementById('pointsCount');
        const responseTimeEl = document.getElementById('responseTime');
        
        // –ë–∞–∑–æ–≤–∞—è URL –≤–∞—à–µ–≥–æ API (–º–µ–Ω—è–π—Ç–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
        const API_BASE_URL = 'http://localhost:8000';
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç—ã
        async function loadMapData() {
            const startTime = performance.now();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            loading.classList.add('active');
            error.classList.remove('active');
            success.classList.remove('active');
            statusEl.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
            
            try {
                // –î–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –∫ API
                const response = await fetch(`${API_BASE_URL}/api/map`);
                const endTime = performance.now();
                const responseTime = endTime - startTime;
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                // –ü–∞—Ä—Å–∏–º JSON
                const data = await response.json();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
                success.classList.add('active');
                statusEl.textContent = '–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ';
                responseTimeEl.textContent = `${responseTime.toFixed(0)} –º—Å`;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞—Ä—Ç–µ
                updateMapInfo(data);
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º SVG –∫–∞—Ä—Ç—É
                await loadAndDisplayMap(data.map_url);
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ—á–∫–∏
                displayPoints(data.points);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—ã—Ä–æ–π –æ—Ç–≤–µ—Ç
                rawResponse.textContent = JSON.stringify(data, null, 2);
                
            } catch (err) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
                error.classList.add('active');
                document.getElementById('errorMessage').textContent = err.message;
                statusEl.textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ä—Ç—ã:', err);
            } finally {
                // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                loading.classList.remove('active');
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞—Ä—Ç–µ
        function updateMapInfo(data) {
            mapTitleEl.textContent = data.tittle || data.title || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è';
            mapUrlEl.textContent = data.map_url;
            pointsCountEl.textContent = data.points?.length || 0;
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ SVG –∫–∞—Ä—Ç—ã
        async function loadAndDisplayMap(mapUrl) {
            try {
                const fullUrl = mapUrl.startsWith('http') ? mapUrl : `${API_BASE_URL}${mapUrl}`;
                const response = await fetch(fullUrl);
                
                if (!response.ok) {
                    throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ä—Ç—É: ${response.status}`);
                }
                
                // –ü–æ–ª—É—á–∞–µ–º SVG –∫–∞–∫ —Ç–µ–∫—Å—Ç
                const svgText = await response.text();
                
                // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –¥–æ–±–∞–≤–ª—è–µ–º SVG
                mapContainer.innerHTML = '';
                mapContainer.insertAdjacentHTML('beforeend', svgText);
                
                // –ü–æ–ª—É—á–∞–µ–º SVG —ç–ª–µ–º–µ–Ω—Ç
                const svgElement = mapContainer.querySelector('svg');
                
                if (svgElement) {
                    // –î–µ–ª–∞–µ–º SVG –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º
                    svgElement.style.width = '100%';
                    svgElement.style.height = '100%';
                    svgElement.style.display = 'block';
                }
                
            } catch (err) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ SVG:', err);
                mapContainer.innerHTML = `
                    <div style="text-align: center; padding: 50px; color: #718096;">
                        <div style="font-size: 48px; margin-bottom: 20px;">üó∫Ô∏è</div>
                        <h3>–ö–∞—Ä—Ç–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞</h3>
                        <p>${err.message}</p>
                        <p style="margin-top: 20px;">URL: ${mapUrl}</p>
                    </div>
                `;
            }
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ—á–µ–∫
        function displayPoints(points) {
            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
            pointsList.innerHTML = '';
            
            if (!points || points.length === 0) {
                pointsList.innerHTML = '<p style="color: #a0aec0; text-align: center; padding: 20px;">–ù–µ—Ç —Ç–æ—á–µ–∫ –Ω–∞ –∫–∞—Ä—Ç–µ</p>';
                return;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞–∂–¥—É—é —Ç–æ—á–∫—É –≤ —Å–ø–∏—Å–æ–∫
            points.forEach(point => {
                const pointEl = document.createElement('div');
                pointEl.className = 'point-item';
                pointEl.dataset.id = point.id;
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –µ—Å—Ç—å –ª–∏ –∞–≤–∞—Ç–∞—Ä–∫–∞
                const avatarHtml = point.avatar_url 
                    ? `<img src="${point.avatar_url}" alt="${point.name}" class="avatar">`
                    : `<div class="no-avatar">${point.name.charAt(0)}</div>`;
                
                pointEl.innerHTML = `
                    <div class="point-header">
                        ${avatarHtml}
                        <div>
                            <div class="point-name">${point.name}</div>
                            <div class="point-coords">X: ${point.x}, Y: ${point.y}</div>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #718096;">
                        ID: ${point.id} | –ê–≤–∞—Ç–∞—Ä: ${point.avatar_url ? '‚úì' : '‚úó'}
                    </div>
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
                pointEl.addEventListener('click', () => {
                    highlightPoint(point);
                });
                
                pointsList.appendChild(pointEl);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Ä–∫–µ—Ä—ã –Ω–∞ –∫–∞—Ä—Ç—É
            addPointMarkers(points);
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ –Ω–∞ –∫–∞—Ä—Ç—É
        function addPointMarkers(points) {
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –º–∞—Ä–∫–µ—Ä—ã
            document.querySelectorAll('.point-marker').forEach(marker => marker.remove());
            
            // –ù–∞—Ö–æ–¥–∏–º SVG —ç–ª–µ–º–µ–Ω—Ç
            const svg = mapContainer.querySelector('svg');
            if (!svg || !points) return;
            
            // –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã SVG
            const svgRect = svg.getBoundingClientRect();
            const svgWidth = svgRect.width;
            const svgHeight = svgRect.height;
            
            // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–µ–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–∞–∑–º–µ—Ä–∞–º SVG
            // –ï—Å–ª–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö, –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å
            points.forEach(point => {
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –ø–∏–∫—Å–µ–ª–∏
                const xPercent = (point.x / 100) * svgWidth;
                const yPercent = (point.y / 100) * svgHeight;
                
                // –°–æ–∑–¥–∞–µ–º –º–∞—Ä–∫–µ—Ä
                const marker = document.createElement('div');
                marker.className = 'point-marker';
                marker.style.left = `${xPercent}px`;
                marker.style.top = `${yPercent}px`;
                marker.title = point.name;
                marker.dataset.id = point.id;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å—å
                const label = document.createElement('div');
                label.className = 'point-label';
                label.textContent = point.name;
                label.style.left = '25px';
                label.style.top = '-10px';
                marker.appendChild(label);
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
                marker.addEventListener('click', (e) => {
                    e.stopPropagation();
                    highlightPoint(point);
                });
                
                marker.addEventListener('mouseenter', () => {
                    // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ç–æ—á–∫—É –≤ —Å–ø–∏—Å–∫–µ
                    const listItem = document.querySelector(`.point-item[data-id="${point.id}"]`);
                    if (listItem) {
                        listItem.style.background = '#bee3f8';
                    }
                });
                
                marker.addEventListener('mouseleave', () => {
                    const listItem = document.querySelector(`.point-item[data-id="${point.id}"]`);
                    if (listItem) {
                        listItem.style.background = '';
                    }
                });
                
                mapContainer.appendChild(marker);
            });
        }
        
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç–æ—á–∫–∏
        function highlightPoint(point) {
            // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤ —Å–ø–∏—Å–∫–µ
            document.querySelectorAll('.point-item').forEach(item => {
                item.style.background = '';
            });
            
            const listItem = document.querySelector(`.point-item[data-id="${point.id}"]`);
            if (listItem) {
                listItem.style.background = '#bee3f8';
                listItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
            
            // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –º–∞—Ä–∫–µ—Ä
            document.querySelectorAll('.point-marker').forEach(marker => {
                marker.style.background = '#e53e3e';
                marker.style.transform = 'translate(-50%, -50%)';
            });
            
            const marker = document.querySelector(`.point-marker[data-id="${point.id}"]`);
            if (marker) {
                marker.style.background = '#f56565';
                marker.style.transform = 'translate(-50%, -50%) scale(1.5)';
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            alert(`–¢–æ—á–∫–∞: ${point.name}\nID: ${point.id}\n–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: X=${point.x}, Y=${point.y}\n–ê–≤–∞—Ç–∞—Ä: ${point.avatar_url || '–Ω–µ—Ç'}`);
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ
        function clearAll() {
            mapContainer.innerHTML = '<p id="mapPlaceholder">–ö–∞—Ä—Ç–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö...</p>';
            pointsList.innerHTML = '<p style="color: #a0aec0; text-align: center; padding: 20px;">–¢–æ—á–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</p>';
            rawResponse.textContent = '{}';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            statusEl.textContent = '–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏...';
            mapTitleEl.textContent = '‚Äî';
            mapUrlEl.textContent = '‚Äî';
            pointsCountEl.textContent = '0';
            responseTimeEl.textContent = '‚Äî';
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
            error.classList.remove('active');
            success.classList.remove('active');
            
            // –£–¥–∞–ª—è–µ–º –º–∞—Ä–∫–µ—Ä—ã
            document.querySelectorAll('.point-marker').forEach(marker => marker.remove());
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        loadBtn.addEventListener('click', loadMapData);
        clearBtn.addEventListener('click', clearAll);
        
        // –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        window.addEventListener('DOMContentLoaded', () => {
            // –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –¥–ª—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏:
            // loadMapData();
            
            // –ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
            console.log('üåç LauraMap –¢–µ—Å—Ç–æ–≤—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥');
            console.log('–ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ä—Ç—É" –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ /api/map');
            console.log('–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ FastAPI —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ ' + API_BASE_URL);
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'l') {
                e.preventDefault();
                loadMapData();
            }
            if (e.key === 'Escape') {
                clearAll();
            }
        });
    </script>
</body>
</html>